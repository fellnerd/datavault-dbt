name: 'datavault'
version: '1.0.0'
config-version: 2

profile: 'datavault'

model-paths: ["models"]
analysis-paths: ["analyses"]
test-paths: ["tests"]
seed-paths: ["seeds"]
macro-paths: ["macros"]
snapshot-paths: ["snapshots"]

clean-targets:
  - "target"
  - "dbt_packages"

seeds:
  datavault:
    +schema: vault

vars:
  # Hash-Algorithmus: MD5 (16 Byte) oder SHA (32 Byte)
  hash: 'SHA'
  
  # Datumsspalte für Load Date
  load_date: 'dss_load_date'
  
  # Record Source Spalte
  record_source: 'dss_record_source'

# ===========================================
# SCHEMA NAMING CONVENTION
# ===========================================
# [vault].[hub_<entity>]         - Hubs
# [vault].[sat_<entity>]         - Satellites
# [vault].[link_<entity>]        - Links
# [stg].[stg_<entity>]           - Staging Views
# [mart_<context>].[<object>]    - Information Mart Views
# [mart_static].[<object>]       - Static Tables (persistierte Marts)

models:
  datavault:
    staging:
      +schema: stg
      +materialized: view
    raw_vault:
      hubs:
        +schema: vault
        +materialized: incremental
        +incremental_strategy: append
        +as_columnstore: false
        +on_schema_change: append_new_columns
      satellites:
        +schema: vault
        +materialized: incremental
        +incremental_strategy: append
        +as_columnstore: false
        +on_schema_change: append_new_columns
      links:
        +schema: vault
        +materialized: incremental
        +incremental_strategy: append
        +as_columnstore: false
        +on_schema_change: append_new_columns
    business_vault:
      +schema: vault
      +materialized: table
      +as_columnstore: false
    mart:
      project:
        +schema: mart_project
        +materialized: view
      # Static Tables (persistierte Marts mit Index)
      tables:
        +schema: mart_static
        +materialized: incremental
        +incremental_strategy: merge
        +unique_key: 'hk_key'
        +as_columnstore: false
        +tags: ['static']
      # Weitere Business Contexts hier hinzufügen:
      # finance:
      #   +schema: mart_finance
      #   +materialized: view
      # hr:
      #   +schema: mart_hr
      #   +materialized: view
